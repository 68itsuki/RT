### 9-6. 実践的なコンポーネント設計例

#### 完全なTodoアプリケーション

```jsx
// メインアプリケーション
function TodoApp() {
  const [todos, setTodos] = useState([]);
  const [filter, setFilter] = useState('all');
  const [sortBy, setSortBy] = useState('created');

  const addTodo = useCallback((text) => {
    const newTodo = {
      id: Date.now(),
      text,
      completed: false,
      createdAt: new Date()
    };
    setTodos(prev => [...prev, newTodo]);
  }, []);

  const toggleTodo = useCallback((id) => {
    setTodos(prev => 
      prev.map(todo => 
        todo.id === id 
          ? { ...todo, completed: !todo.completed }
          : todo
      )
    );
  }, []);

  const deleteTodo = useCallback((id) => {
    setTodos(prev => prev.filter(todo => todo.id !== id));
  }, []);

  const filteredAndSortedTodos = useMemo(() => {
    let result = todos;
    
    // フィルタリング
    if (filter === 'active') {
      result = result.filter(todo => !todo.completed);
    } else if (filter === 'completed') {
      result = result.filter(todo => todo.completed);
    }
    
    // ソート
    if (sortBy === 'created') {
      result.sort((a, b) => b.createdAt - a.createdAt);
    } else if (sortBy === 'text') {
      result.sort((a, b) => a.text.localeCompare(b.text));
    }
    
    return result;
  }, [todos, filter, sortBy]);

  return (
    <div className="todo-app">
      <TodoHeader />
      <TodoForm onAdd={addTodo} />
      <TodoFilters 
        filter={filter} 
        onFilterChange={setFilter}
        sortBy={sortBy}
        onSortChange={setSortBy}
      />
      <TodoList 
        todos={filteredAndSortedTodos}
        onToggle={toggleTodo}
        onDelete={deleteTodo}
      />
      <TodoStats todos={todos} />
    </div>
  );
}

// 各コンポーネント
function TodoHeader() {
  return <h1>Todoアプリケーション</h1>;
}

function TodoForm({ onAdd }) {
  const [input, setInput] = useState('');

  const handleSubmit = (e) => {
    e.preventDefault();
    if (input.trim()) {
      onAdd(input.trim());
      setInput('');
    }
  };

  return (
    <form onSubmit={handleSubmit} className="todo-form">
      <input
        type="text"
        value={input}
        onChange={(e) => setInput(e.target.value)}
        placeholder="新しいタスクを入力..."
        className="todo-input"
      />
      <button type="submit" className="todo-add-btn">
        追加
      </button>
    </form>
  );
}

function TodoFilters({ filter, onFilterChange, sortBy, onSortChange }) {
  return (
    <div className="todo-filters">
      <div className="filter-group">
        <label>フィルター:</label>
        <select value={filter} onChange={(e) => onFilterChange(e.target.value)}>
          <option value="all">すべて</option>
          <option value="active">未完了</option>
          <option value="completed">完了済み</option>
        </select>
      </div>
      
      <div className="sort-group">
        <label>ソート:</label>
        <select value={sortBy} onChange={(e) => onSortChange(e.target.value)}>
          <option value="created">作成日順</option>
          <option value="text">テキスト順</option>
        </select>
      </div>
    </div>
  );
}

const TodoList = React.memo(function TodoList({ todos, onToggle, onDelete }) {
  if (todos.length === 0) {
    return <p className="no-todos">タスクがありません</p>;
  }

  return (
    <ul className="todo-list">
      {todos.map(todo => (
        <TodoItem 
          key={todo.id}
          todo={todo}
          onToggle={onToggle}
          onDelete={onDelete}
        />
      ))}
    </ul>
  );
});

const TodoItem = React.memo(function TodoItem({ todo, onToggle, onDelete }) {
  return (
    <li className={`todo-item ${todo.completed ? 'completed' : ''}`}>
      <input
        type="checkbox"
        checked={todo.completed}
        onChange={() => onToggle(todo.id)}
        className="todo-checkbox"
      />
      <span className="todo-text">{todo.text}</span>
      <button 
        onClick={() => onDelete(todo.id)}
        className="todo-delete-btn"
      >
        削除
      </button>
    </li>
  );
});

function TodoStats({ todos }) {
  const total = todos.length;
  const completed = todos.filter(todo => todo.completed).length;
  const active = total - completed;

  return (
    <div className="todo-stats">
      <p>総タスク数: {total}</p>
      <p>完了済み: {completed}</p>
      <p>未完了: {active}</p>
    </div>
  );
}

// PropTypesの定義
TodoForm.propTypes = {
  onAdd: PropTypes.func.isRequired
};

TodoFilters.propTypes = {
  filter: PropTypes.oneOf(['all', 'active', 'completed']).isRequired,
  onFilterChange: PropTypes.func.isRequired,
  sortBy: PropTypes.oneOf(['created', 'text']).isRequired,
  onSortChange: PropTypes.func.isRequired
};

TodoList.propTypes = {
  todos: PropTypes.arrayOf(
    PropTypes.shape({
      id: PropTypes.number.isRequired,
      text: PropTypes.string.isRequired,
      completed: PropTypes.bool.isRequired,
      createdAt: PropTypes.instanceOf(Date).isRequired
    })
  ).isRequired,
  onToggle: PropTypes.func.isRequired,
  onDelete: PropTypes.func.isRequired
};

TodoItem.propTypes = {
  todo: PropTypes.shape({
    id: PropTypes.number.isRequired,
    text: PropTypes.string.isRequired,
    completed: PropTypes.bool.isRequired
  }).isRequired,
  onToggle: PropTypes.func.isRequired,
  onDelete: PropTypes.func.isRequired
};

TodoStats.propTypes = {
  todos: PropTypes.array.isRequired
};
```